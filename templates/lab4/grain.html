{% extends "base.html" %}

{% block lab %}Заказ зерна{% endblock %}

{% block main %}
    <div style="max-width: 600px; margin: 0 auto;">
        <h1 style="text-align: center;">Заказ зерна</h1>
        
        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 20px 0; border: 1px solid #ffeaa7;">
            <h3 style="color: #856404; margin-top: 0;">Цены за тонну:</h3>
            <ul style="color: #856404;">
                <li><strong>Ячмень:</strong> 12 000 руб/т</li>
                <li><strong>Овёс:</strong> 8 500 руб/т</li>
                <li><strong>Пшеница:</strong> 9 000 руб/т</li>
                <li><strong>Рожь:</strong> 15 000 руб/т</li>
            </ul>
            <p style="color: #856404; margin-bottom: 0;">
                <strong>Скидка:</strong> 10% при заказе более 10 тонн<br>
                <strong>Максимальный заказ:</strong> 100 тонн
            </p>
        </div>
        
        <form method="post" action="/lab4/grain" style="background: #f8f9fa; padding: 25px; border-radius: 10px; margin: 20px 0;">
            <div style="margin-bottom: 25px;">
                <label for="grain_type" style="display: block; margin-bottom: 8px; font-weight: bold; font-size: 1.1em;">
                    Выберите тип зерна:
                </label>
                <select id="grain_type" name="grain_type" style="padding: 12px; width: 100%; border: 2px solid #3498db; border-radius: 8px; font-size: 16px;">
                    <option value="">-- Выберите зерно --</option>
                    <option value="barley">Ячмень (12 000 руб/т)</option>
                    <option value="oats">Овёс (8 500 руб/т)</option>
                    <option value="wheat">Пшеница (9 000 руб/т)</option>
                    <option value="rye">Рожь (15 000 руб/т)</option>
                </select>
            </div>
            
            <div style="margin-bottom: 25px;">
                <label for="weight" style="display: block; margin-bottom: 8px; font-weight: bold; font-size: 1.1em;">
                    Вес заказа (в тоннах):
                </label>
                <input type="number" id="weight" name="weight" 
                       min="0.1" max="100" step="0.1"
                       style="padding: 12px; width: 100%; border: 2px solid #3498db; border-radius: 8px; font-size: 16px;"
                       placeholder="Введите вес от 0.1 до 100 тонн">
            </div>
            
            <button type="submit" style="background: #27ae60; color: white; padding: 15px 30px; border: none; border-radius: 8px; cursor: pointer; width: 100%; font-size: 16px; font-weight: bold;">
                Оформить заказ
            </button>
        </form>

        {% if error %}
            <div style="color: #e74c3c; background: #ffe6e6; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #e74c3c;">
                <strong>Ошибка:</strong> {{ error }}
            </div>
        {% endif %}

        {% if success %}
            <div style="background: #e6f7e6; padding: 25px; border-radius: 10px; margin: 20px 0; border: 2px solid #27ae60;">
                <h3 style="color: #27ae60; margin-bottom: 15px;">Заказ успешно сформирован</h3>
                
                <div style="font-size: 1.1em; line-height: 1.6;">
                    <p><strong>Вы заказали:</strong> {{ grain_name }}</p>
                    <p><strong>Вес:</strong> {{ "%.1f"|format(weight) }} т</p>
                    
                    {% if has_discount %}
                        <div style="background: #d4edda; padding: 15px; border-radius: 5px; margin: 15px 0;">
                            <p style="color: #155724; margin: 0;">
                                <strong>Применена скидка 10% за большой объём!</strong><br>
                                <strong>Размер скидки:</strong> {{ "%.0f"|format(discount) }} руб
                            </p>
                        </div>
                    {% endif %}
                    
                    <p style="font-size: 1.2em; font-weight: bold; margin-top: 15px;">
                        Сумма к оплате: {{ "%.0f"|format(total) }} руб
                    </p>
                </div>
            </div>
        {% endif %}

        <div style="text-align: center; margin-top: 20px;">
            <a href="/lab4/" style="display: inline-block; background: #666; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
                ← Назад к меню
            </a>
        </div>
    </div>
{% endblock %}