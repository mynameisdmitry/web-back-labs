{% extends "base.html" %}

{% block lab %}–°—Ç–∞—Ç—å–∏ ‚Äî –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π{% endblock %}

{% block main %}
<div class="card">
    <h2>–°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π</h2>
    
    <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
    <form method="get" action="/lab8/articles" style="margin-bottom: 25px; background: #f8f9fa; padding: 15px; border-radius: 8px;">
        <div style="display: flex; gap: 10px; align-items: center;">
            <div style="flex: 1; position: relative;">
                <span style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 1.2em;">üîç</span>
                <input name="search" class="form-control" type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—å—è–º..." value="{{ search_query if search_query else '' }}" style="border: 2px solid #e1e4e8; border-radius: 6px; padding: 10px 10px 10px 38px; font-size: 1em; width: 100%;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e1e4e8'">
            </div>
            <button class="btn" type="submit" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; white-space: nowrap;" onmouseover="this.style.background='#5568d3'" onmouseout="this.style.background='#667eea'">–ù–∞–π—Ç–∏</button>
            {% if search_query %}
                <a href="/lab8/articles" class="btn" style="background: #6c757d; color: white; text-decoration: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; white-space: nowrap;" onmouseover="this.style.background='#5a6268'" onmouseout="this.style.background='#6c757d'">–°–±—Ä–æ—Å–∏—Ç—å</a>
            {% endif %}
        </div>
    </form>
    
    {% if articles %}
        <div style="display: grid; gap: 20px;">
        {% for a in articles %}
            <div style="background: white; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); transition: all 0.2s;" onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)'; this.style.borderColor='#667eea'" onmouseout="this.style.boxShadow='0 1px 3px rgba(0,0,0,0.05)'; this.style.borderColor='#e1e4e8'">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                    <div style="flex: 1;">
                        <h3 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 1.3em;">
                            {{ a.title }}
                            {% if a.is_public %}
                                <span style="display: inline-block; background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; font-size: 0.6em; padding: 3px 8px; border-radius: 4px; margin-left: 8px; font-weight: 500;">–ü—É–±–ª–∏—á–Ω–∞—è</span>
                            {% else %}
                                <span style="display: inline-block; background: #e1e4e8; color: #586069; font-size: 0.6em; padding: 3px 8px; border-radius: 4px; margin-left: 8px; font-weight: 500;">–ü—Ä–∏–≤–∞—Ç–Ω–∞—è</span>
                            {% endif %}
                        </h3>
                        <div style="color: #586069; font-size: 0.9em;">
                            <span style="margin-right: 15px;">üë§ {{ a.author_login if a.author_login else ('user_id:' ~ a.login_id) }}</span>
                            {% if a.login_id == current_user.id %}
                                <span style="color: #667eea; font-weight: 500;">‚úì –í–∞—à–∞ —Å—Ç–∞—Ç—å—è</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <p style="color: #586069; margin: 12px 0; line-height: 1.6;">
                    {{ a.article_text[:150] }}{% if a.article_text|length > 150 %}...{% endif %}
                </p>
                {% if a.login_id == current_user.id %}
                    <div style="display: flex; gap: 10px; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e1e4e8;">
                        <a href="/lab8/articles/{{ a.id }}/edit" style="padding: 8px 16px; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-size: 0.9em; font-weight: 500; transition: background 0.2s;" onmouseover="this.style.background='#5568d3'" onmouseout="this.style.background='#667eea'">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <form method="post" action="/lab8/articles/{{ a.id }}/delete" style="display:inline; margin: 0;" onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é?');">
                            <button type="submit" style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; font-size: 0.9em; font-weight: 500; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#c82333'" onmouseout="this.style.background='#dc3545'">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 60px 20px; color: #586069;">
            <div style="font-size: 4em; margin-bottom: 20px; opacity: 0.5;">üì≠</div>
            <p style="font-size: 1.2em; margin: 0;">{% if search_query %}–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.{% else %}–°—Ç–∞—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!{% endif %}</p>
        </div>
    {% endif %}
    
    <div style="margin-top: 30px; text-align: center;">
        <a href="/lab8/create" style="display: inline-block; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; text-decoration: none; padding: 14px 28px; border-radius: 8px; font-weight: 600; font-size: 1.05em; box-shadow: 0 4px 12px rgba(245, 87, 108, 0.3); transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">‚ú® –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç–∞—Ç—å—é</a>
    </div>
</div>
{% endblock %}